"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[7049],{6768:(w,y,a)=>{a.d(y,{t:()=>I});var r=a(4650),h=a(7747),d=a(5384),f=a(4006),O=a(2210);let I=(()=>{class g{constructor(v,t){this.commonService=v,this.eventService=t,this.ValueSelectedChange=new r.vpe,this.categorys=[],this.Filter=!1}ngOnInit(){this.data=this.DropDownDataSource,this.Filter=this.showFilter}changeValue(){this.ValueSelected=this.selectedData?.value,this.ValueSelectedChange.emit(this.ValueSelected)}selectedValue(){this.ValueSelected=this.selectedData?.value,this.ValueSelectedChange.emit(this.ValueSelected)}static#t=this.\u0275fac=function(t){return new(t||g)(r.Y36(h.M),r.Y36(d.P))};static#e=this.\u0275cmp=r.Xpm({type:g,selectors:[["app-drop-down"]],inputs:{ValueSelected:"ValueSelected",IsCreating:"IsCreating",showFilter:"showFilter",DropDownDataSource:"DropDownDataSource"},outputs:{ValueSelectedChange:"ValueSelectedChange"},decls:1,vars:3,consts:[["optionLabel","viewValue",3,"filter","options","ngModel","onClick","onChange","ngModelChange"]],template:function(t,p){1&t&&(r.TgZ(0,"p-dropdown",0),r.NdJ("onClick",function(){return p.selectedValue()})("onChange",function(){return p.changeValue()})("ngModelChange",function(u){return p.selectedData=u}),r.qZA()),2&t&&r.Q6J("filter",p.Filter)("options",p.data)("ngModel",p.selectedData)},dependencies:[f.JJ,f.On,O.Lt],encapsulation:2})}return g})()},7116:(w,y,a)=>{a.d(y,{R:()=>d});var r=a(4650),h=a(3162);let d=(()=>{class f{constructor(){}static#t=this.\u0275fac=function(g){return new(g||f)};static#e=this.\u0275cmp=r.Xpm({type:f,selectors:[["app-progress-bar"]],decls:1,vars:0,consts:[["mode","indeterminate"]],template:function(g,A){1&g&&r._UZ(0,"mat-progress-bar",0)},dependencies:[h.pW],encapsulation:2})}return f})()},7049:(w,y,a)=>{a.r(y),a.d(y,{InvoiceCreatorModule:()=>At});var r=a(6895),h=a(9197),d=a(4006),f=a(8675),O=a(4004);class I{constructor(c,e,i,o,s,l){this.productCode=c,this.productName=e,this.quantity=i,this.unitPrice=o,this.discounts=s,this.total=l}}class g{constructor(c,e,i,o){this.lines=c,this.Pay=e,this.Id=i,this.Document=o}}class A{constructor(c){this.PoId=c.id,this.PayEnterpriseId=c.payEnterpriseId,this.Amount=c.total,this.Name=c.nombre}}var v=a(805),t=a(4650),p=a(7747),m=a(5384),u=a(5593),b=a(7116),E=a(6768),M=a(3805),S=a(3238),F=a(2453),B=a(1383),U=a(1493),Z=a(8184),L=a(7725),V=a(6270),K=a(445),N=a(1281),J=a(9521),G=a(2289),q=a(3353),$=a(4080),H=a(7579),T=a(2722),W=a(5698);a(7340);const tt=["tooltip"],Q="tooltip-panel",z=(0,q.i$)({passive:!0}),j=new t.OlP("mat-tooltip-scroll-strategy"),nt={provide:j,deps:[Z.aV],useFactory:function ot(n){return()=>n.scrollStrategies.reposition({scrollThrottle:20})}},st=new t.OlP("mat-tooltip-default-options",{providedIn:"root",factory:function rt(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}});let at=(()=>{class n{constructor(e,i,o,s,l,C,P,R,Y,D,x,k){this._overlay=e,this._elementRef=i,this._scrollDispatcher=o,this._viewContainerRef=s,this._ngZone=l,this._platform=C,this._ariaDescriber=P,this._focusMonitor=R,this._dir=D,this._defaultOptions=x,this._position="below",this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._viewportMargin=8,this._cssClassPrefix="mat",this._showDelay=this._defaultOptions.showDelay,this._hideDelay=this._defaultOptions.hideDelay,this.touchGestures="auto",this._message="",this._passiveListeners=[],this._destroyed=new H.x,this._scrollStrategy=Y,this._document=k,x&&(x.position&&(this.position=x.position),x.touchGestures&&(this.touchGestures=x.touchGestures)),D.change.pipe((0,T.R)(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)})}get position(){return this._position}set position(e){e!==this._position&&(this._position=e,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get disabled(){return this._disabled}set disabled(e){this._disabled=(0,N.Ig)(e),this._disabled?this.hide(0):this._setupPointerEnterEventsIfNeeded()}get showDelay(){return this._showDelay}set showDelay(e){this._showDelay=(0,N.su)(e)}get hideDelay(){return this._hideDelay}set hideDelay(e){this._hideDelay=(0,N.su)(e),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this._message,"tooltip"),this._message=null!=e?String(e).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage(),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}get tooltipClass(){return this._tooltipClass}set tooltipClass(e){this._tooltipClass=e,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe((0,T.R)(this._destroyed)).subscribe(e=>{e?"keyboard"===e&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){const e=this._elementRef.nativeElement;clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([i,o])=>{e.removeEventListener(i,o,z)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(e,this.message,"tooltip"),this._focusMonitor.stopMonitoring(e)}show(e=this.showDelay){if(this.disabled||!this.message||this._isTooltipVisible())return void this._tooltipInstance?._cancelPendingAnimations();const i=this._createOverlay();this._detach(),this._portal=this._portal||new $.C5(this._tooltipComponent,this._viewContainerRef);const o=this._tooltipInstance=i.attach(this._portal).instance;o._triggerElement=this._elementRef.nativeElement,o._mouseLeaveHideDelay=this._hideDelay,o.afterHidden().pipe((0,T.R)(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),o.show(e)}hide(e=this.hideDelay){const i=this._tooltipInstance;i&&(i.isVisible()?i.hide(e):(i._cancelPendingAnimations(),this._detach()))}toggle(){this._isTooltipVisible()?this.hide():this.show()}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(){if(this._overlayRef)return this._overlayRef;const e=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),i=this._overlay.position().flexibleConnectedTo(this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(e);return i.positionChanges.pipe((0,T.R)(this._destroyed)).subscribe(o=>{this._updateCurrentPositionClass(o.connectionPair),this._tooltipInstance&&o.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:i,panelClass:`${this._cssClassPrefix}-${Q}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe((0,T.R)(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe((0,T.R)(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe((0,T.R)(this._destroyed)).subscribe(o=>{this._isTooltipVisible()&&o.keyCode===J.hY&&!(0,J.Vb)(o)&&(o.preventDefault(),o.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(e){const i=e.getConfig().positionStrategy,o=this._getOrigin(),s=this._getOverlayPosition();i.withPositions([this._addOffset({...o.main,...s.main}),this._addOffset({...o.fallback,...s.fallback})])}_addOffset(e){return e}_getOrigin(){const e=!this._dir||"ltr"==this._dir.value,i=this.position;let o;"above"==i||"below"==i?o={originX:"center",originY:"above"==i?"top":"bottom"}:"before"==i||"left"==i&&e||"right"==i&&!e?o={originX:"start",originY:"center"}:("after"==i||"right"==i&&e||"left"==i&&!e)&&(o={originX:"end",originY:"center"});const{x:s,y:l}=this._invertPosition(o.originX,o.originY);return{main:o,fallback:{originX:s,originY:l}}}_getOverlayPosition(){const e=!this._dir||"ltr"==this._dir.value,i=this.position;let o;"above"==i?o={overlayX:"center",overlayY:"bottom"}:"below"==i?o={overlayX:"center",overlayY:"top"}:"before"==i||"left"==i&&e||"right"==i&&!e?o={overlayX:"end",overlayY:"center"}:("after"==i||"right"==i&&e||"left"==i&&!e)&&(o={overlayX:"start",overlayY:"center"});const{x:s,y:l}=this._invertPosition(o.overlayX,o.overlayY);return{main:o,fallback:{overlayX:s,overlayY:l}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),this._ngZone.onMicrotaskEmpty.pipe((0,W.q)(1),(0,T.R)(this._destroyed)).subscribe(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()}))}_setTooltipClass(e){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=e,this._tooltipInstance._markForCheck())}_invertPosition(e,i){return"above"===this.position||"below"===this.position?"top"===i?i="bottom":"bottom"===i&&(i="top"):"end"===e?e="start":"start"===e&&(e="end"),{x:e,y:i}}_updateCurrentPositionClass(e){const{overlayY:i,originX:o,originY:s}=e;let l;if(l="center"===i?this._dir&&"rtl"===this._dir.value?"end"===o?"left":"right":"start"===o?"left":"right":"bottom"===i&&"top"===s?"above":"below",l!==this._currentPosition){const C=this._overlayRef;if(C){const P=`${this._cssClassPrefix}-${Q}-`;C.removePanelClass(P+this._currentPosition),C.addPanelClass(P+l)}this._currentPosition=l}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",()=>{this._setupPointerExitEventsIfNeeded(),this.show()}]):"off"!==this.touchGestures&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",()=>{this._setupPointerExitEventsIfNeeded(),clearTimeout(this._touchstartTimeout),this._touchstartTimeout=setTimeout(()=>this.show(),500)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;const e=[];if(this._platformSupportsMouseEvents())e.push(["mouseleave",i=>{const o=i.relatedTarget;(!o||!this._overlayRef?.overlayElement.contains(o))&&this.hide()}],["wheel",i=>this._wheelListener(i)]);else if("off"!==this.touchGestures){this._disableNativeGesturesIfNecessary();const i=()=>{clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};e.push(["touchend",i],["touchcancel",i])}this._addListeners(e),this._passiveListeners.push(...e)}_addListeners(e){e.forEach(([i,o])=>{this._elementRef.nativeElement.addEventListener(i,o,z)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(e){if(this._isTooltipVisible()){const i=this._document.elementFromPoint(e.clientX,e.clientY),o=this._elementRef.nativeElement;i!==o&&!o.contains(i)&&this.hide()}}_disableNativeGesturesIfNecessary(){const e=this.touchGestures;if("off"!==e){const i=this._elementRef.nativeElement,o=i.style;("on"===e||"INPUT"!==i.nodeName&&"TEXTAREA"!==i.nodeName)&&(o.userSelect=o.msUserSelect=o.webkitUserSelect=o.MozUserSelect="none"),("on"===e||!i.draggable)&&(o.webkitUserDrag="none"),o.touchAction="none",o.webkitTapHighlightColor="transparent"}}}return n.\u0275fac=function(e){t.$Z()},n.\u0275dir=t.lG2({type:n,inputs:{position:["matTooltipPosition","position"],disabled:["matTooltipDisabled","disabled"],showDelay:["matTooltipShowDelay","showDelay"],hideDelay:["matTooltipHideDelay","hideDelay"],touchGestures:["matTooltipTouchGestures","touchGestures"],message:["matTooltip","message"],tooltipClass:["matTooltipClass","tooltipClass"]}}),n})(),lt=(()=>{class n extends at{constructor(e,i,o,s,l,C,P,R,Y,D,x,k){super(e,i,o,s,l,C,P,R,Y,D,x,k),this._tooltipComponent=dt}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.aV),t.Y36(t.SBq),t.Y36(V.mF),t.Y36(t.s_b),t.Y36(t.R0b),t.Y36(q.t4),t.Y36(L.$s),t.Y36(L.tE),t.Y36(j),t.Y36(K.Is,8),t.Y36(st,8),t.Y36(r.K0))},n.\u0275dir=t.lG2({type:n,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-tooltip-trigger"],exportAs:["matTooltip"],features:[t.qOj]}),n})(),ct=(()=>{class n{constructor(e,i){this._changeDetectorRef=e,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new H.x,this._animationsDisabled="NoopAnimations"===i}show(e){clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},e)}hide(e){clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},e)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:e}){(!e||!this._triggerElement.contains(e))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){}_handleAnimationEnd({animationName:e}){(e===this._showAnimation||e===this._hideAnimation)&&this._finalizeAnimation(e===this._showAnimation)}_cancelPendingAnimations(){clearTimeout(this._showTimeoutId),clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(e){e?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(e){const i=this._tooltip.nativeElement,o=this._showAnimation,s=this._hideAnimation;if(i.classList.remove(e?s:o),i.classList.add(e?o:s),this._isVisible=e,e&&!this._animationsDisabled&&"function"==typeof getComputedStyle){const l=getComputedStyle(i);("0s"===l.getPropertyValue("animation-duration")||"none"===l.getPropertyValue("animation-name"))&&(this._animationsDisabled=!0)}e&&this._onShow(),this._animationsDisabled&&(i.classList.add("_mat-animation-noopable"),this._finalizeAnimation(e))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(t.QbO,8))},n.\u0275dir=t.lG2({type:n}),n})(),dt=(()=>{class n extends ct{constructor(e,i,o){super(e,o),this._breakpointObserver=i,this._isHandset=this._breakpointObserver.observe(G.u3.Handset),this._showAnimation="mat-tooltip-show",this._hideAnimation="mat-tooltip-hide"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(G.Yg),t.Y36(t.QbO,8))},n.\u0275cmp=t.Xpm({type:n,selectors:[["mat-tooltip-component"]],viewQuery:function(e,i){if(1&e&&t.Gf(tt,7),2&e){let o;t.iGM(o=t.CRH())&&(i._tooltip=o.first)}},hostAttrs:["aria-hidden","true"],hostVars:2,hostBindings:function(e,i){1&e&&t.NdJ("mouseleave",function(s){return i._handleMouseLeave(s)}),2&e&&t.Udp("zoom",i.isVisible()?1:null)},features:[t.qOj],decls:4,vars:6,consts:[[1,"mat-tooltip",3,"ngClass","animationend"],["tooltip",""]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0,1),t.NdJ("animationend",function(s){return i._handleAnimationEnd(s)}),t.ALo(2,"async"),t._uU(3),t.qZA()),2&e){let o;t.ekj("mat-tooltip-handset",null==(o=t.lcZ(2,4,i._isHandset))?null:o.matches),t.Q6J("ngClass",i.tooltipClass),t.xp6(3),t.Oqu(i.message)}},dependencies:[r.mk,r.Ov],styles:[".mat-tooltip{color:#fff;border-radius:4px;margin:14px;max-width:250px;padding-left:8px;padding-right:8px;overflow:hidden;text-overflow:ellipsis;transform:scale(0)}.mat-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.cdk-high-contrast-active .mat-tooltip{outline:solid 1px}.mat-tooltip-handset{margin:24px;padding-left:16px;padding-right:16px}.mat-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-tooltip-show{0%{opacity:0;transform:scale(0)}50%{opacity:.5;transform:scale(0.99)}100%{opacity:1;transform:scale(1)}}@keyframes mat-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(1)}}.mat-tooltip-show{animation:mat-tooltip-show 200ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-tooltip-hide{animation:mat-tooltip-hide 100ms cubic-bezier(0, 0, 0.2, 1) forwards}"],encapsulation:2,changeDetection:0}),n})(),pt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[nt],imports:[L.rt,r.ez,Z.U8,S.BQ,S.BQ,V.ZD]}),n})();function ut(n,c){1&n&&(t.TgZ(0,"div"),t._UZ(1,"app-progress-bar"),t.qZA())}function ht(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",24)(1,"label",25),t._uU(2,"Proveedor: "),t.qZA(),t.TgZ(3,"app-drop-down",26),t.NdJ("ValueSelectedChange",function(o){t.CHM(e);const s=t.oxw(2);return t.KtG(s.filterSuplier(o))}),t.qZA()()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("showFilter",!0)("IsCreating",!1)("DropDownDataSource",e.suppliers)}}function mt(n,c){if(1&n&&(t.TgZ(0,"div",24)(1,"label",25),t._uU(2,"Proveedor: "),t.qZA(),t._uU(3),t.qZA()),2&n){const e=t.oxw(2);t.xp6(3),t.hij(" ",e.supplierName," ")}}function _t(n,c){if(1&n&&(t.TgZ(0,"div",20),t.YNc(1,ht,4,3,"div",23),t.YNc(2,mt,4,1,"div",23),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",!e.IsLoading&&e.isCreating),t.xp6(1),t.Q6J("ngIf",!e.IsLoading&&!e.isCreating)}}function gt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",27),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.showAddPaymentsModal())}),t.qZA()}}function ft(n,c){if(1&n&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&n){const e=c.$implicit;t.hYB("matTooltip","",e.code," - ",e.name,""),t.Q6J("value",e.code),t.xp6(1),t.AsE(" ",e.code," - ",e.name," ")}}function vt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",28)(1,"div",9),t._UZ(2,"input",29),t.TgZ(3,"mat-autocomplete",null,30),t.YNc(5,ft,2,5,"mat-option",31),t.qZA()(),t.TgZ(6,"div",9),t._UZ(7,"input",32),t.qZA(),t.TgZ(8,"div",9),t._UZ(9,"input",33),t.qZA(),t.TgZ(10,"div",10),t._UZ(11,"input",34),t.qZA(),t.TgZ(12,"div",10),t._UZ(13,"input",35),t.qZA(),t.TgZ(14,"div",10),t._UZ(15,"input",36),t.qZA(),t.TgZ(16,"div",10),t._UZ(17,"input",37),t.qZA(),t.TgZ(18,"div",11)(19,"p-button",38),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw();return t.KtG(l.addLine(s))}),t.qZA(),t.TgZ(20,"p-button",39),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw();return t.KtG(l.removeLine(s))}),t.qZA()()()}if(2&n){const e=c.$implicit,i=c.index,o=t.MAs(4);t.Q6J("formGroupName",i),t.xp6(2),t.Q6J("formControlName","productSearch")("matAutocomplete",o),t.xp6(3),t.Q6J("ngForOf",e.get("filteredProducts").value)}}function Ct(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",43)(1,"span",44),t._uU(2),t.qZA(),t.TgZ(3,"span",45),t._uU(4),t.qZA(),t.TgZ(5,"input",46),t.NdJ("ngModelChange",function(o){const l=t.CHM(e).$implicit;return t.KtG(l.total=o)}),t.qZA()()}if(2&n){const e=c.$implicit;t.xp6(2),t.Oqu(e.id),t.xp6(2),t.Oqu(e.nombre),t.xp6(1),t.Q6J("ngModel",e.total)}}function yt(n,c){if(1&n&&(t.TgZ(0,"div",41),t.YNc(1,Ct,6,3,"div",42),t.TgZ(2,"span",14)(3,"strong"),t._uU(4),t.ALo(5,"currency"),t.qZA()()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.items),t.xp6(1),t.Q6J("ngClass",e.calculateTotal()-e.calculatePaymentTotal()==0?"green-text":"red-text"),t.xp6(2),t.hij("Balance: ",t.xi3(5,3,e.calculateTotal()-e.calculatePaymentTotal(),"L. "),"")}}function bt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.hideDialog())}),t.qZA()}}function Tt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"div",41)(1,"div")(2,"input",48),t.NdJ("ngModelChange",function(o){t.CHM(e);const s=t.oxw();return t.KtG(s.documentDetail=o)}),t.qZA()()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngModel",e.documentDetail)}}function Pt(n,c){if(1&n){const e=t.EpF();t.TgZ(0,"button",47),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.hideDialog())}),t.qZA(),t.TgZ(1,"button",49),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.savePoReception())}),t.qZA()}}const xt=function(){return{width:"650px"}},It=function(){return{width:"450px"}};let Mt=(()=>{class n{editTotal(e,i){e.total=i}constructor(e,i,o,s,l,C){this.route=e,this.router=i,this.fb=o,this.productService=s,this.eventService=l,this.messageService=C,this.isNewPo=!0,this.actualSupplier="",this.showAddPayments=!1,this.items=[],this.documentDetail="",this.initialLines=[{productSearch:"P001",productCode:"P001",productName:"Producto 1",quantity:2,unitPrice:10,discounts:0,total:20},{productSearch:"P002",productCode:"P002",productName:"Producto 2",quantity:1,unitPrice:20,discounts:0,total:20}],this.products=[],this.isCreating=!1,this.route.queryParams.subscribe(P=>{this.poNumber=JSON.parse(P.po),0==this.poNumber||null==this.poNumber?(this.GetPurchaseOrder(0),this.isCreating=!0):this.isCreating=!1})}ngOnInit(){this.GetProductsByWareHouse(),this.GetSupplierValuesByEnterprise(),this.invoiceForm=this.fb.group({lines:this.fb.array([])}),this.isCreating?this.addLine():this.GetPurchaseOrder(this.poNumber)}get lines(){return this.invoiceForm.get("lines")}addLine(e){const i=this.fb.group({productSearch:["",d.kI.required],productCode:["",d.kI.required],productName:["",d.kI.required],quantity:[1,[d.kI.required,d.kI.min(1)]],unitPrice:[0,[d.kI.required,d.kI.min(0)]],discounts:[0],total:[0]});this.setupProductSearch(i),i.get("quantity").valueChanges.subscribe(()=>this.updateLineTotal(i)),i.get("unitPrice").valueChanges.subscribe(()=>this.updateLineTotal(i)),i.get("discounts").valueChanges.subscribe(()=>this.updateLineTotal(i)),void 0!==e?this.lines.insert(e+1,i):this.lines.push(i)}setupProductSearch(e){const i=e.get("productSearch");i.valueChanges.pipe((0,f.O)(""),(0,O.U)(o=>this._filter(o))).subscribe(o=>{e.setControl("filteredProducts",this.fb.control(o))}),i.valueChanges.subscribe(o=>{const s=this.products.find(l=>l.code===o||l.name===o);s&&e.patchValue({productCode:s.code,productName:s.name,unitPrice:s.price})})}_filter(e){const i=e.toString().toLowerCase();return this.products.filter(o=>o.name.toString().toLowerCase().includes(i)||o.code.toString().toLowerCase().includes(i))}removeLine(e){this.lines.length>1&&this.lines.removeAt(e)}updateLineTotal(e){const i=e.get("quantity").value,o=e.get("unitPrice").value,s=e.get("discounts").value;e.patchValue({total:i*o-i*s})}savePo(){this.isCreating?this.onSubmit():this.showDocumentDetail()}onSubmit(){if(this.calculateTotal()==this.calculatePaymentTotal()){if(this.IsLoading)this.messageService.add({severity:"info",summary:"info",detail:"Espere que termine de cargar el proceso",life:3e3});else if(this.invoiceForm.valid){const e=this.lines.value.map(s=>new I(s.productCode,s.productName,s.quantity,s.unitPrice,s.discounts,s.total)),i=this.items.map(s=>new A(s)),o=new g(e,i,this.poNumber,this.documentDetail);o.customer=Number(this.actualSupplier),this.PostAccountTransaction(o)}}else this.messageService.add({severity:"error",summary:"Error",detail:"El balance debe estar en 0",life:3e3})}initializeInitialLines(){console.log(this.initialLines),this.initialLines.forEach(e=>this.addInitialLine(e))}addInitialLine(e){const i=this.fb.group({productSearch:[e.productSearch,d.kI.required],productCode:[e.productCode,d.kI.required],productName:[e.productName,d.kI.required],quantity:[e.quantity,[d.kI.required,d.kI.min(1)]],unitPrice:[e.unitPrice,[d.kI.required,d.kI.min(0)]],discounts:[e.discounts,[d.kI.min(0)]],total:[e.total]});this.setupProductSearch(i),i.get("quantity").valueChanges.subscribe(()=>this.updateLineTotal(i)),i.get("unitPrice").valueChanges.subscribe(()=>this.updateLineTotal(i)),i.get("discounts").valueChanges.subscribe(()=>this.updateLineTotal(i)),this.lines.push(i)}calculateTotal(){return this.lines.controls.reduce((e,i)=>e+(i.get("total").value||0),0)}calculatePaymentTotal(){return this.items.reduce((e,i)=>e+(i.total||0),0)}filterSuplier(e){this.actualSupplier=e}GetSupplierValuesByEnterprise(){this.productService.GetSupplierValues(this.eventService.getToken()).subscribe(e=>{e.data?this.suppliers=e.data:this.messageService.add({severity:"error",summary:"Error",detail:"No tiene productos creados",life:3e3}),this.IsLoading=!1})}showAddPaymentsModal(){this.showAddPayments=!0,console.log(this.items)}hideDialog(){this.showAddPayments=!1,this.showAddDocumentDetail=!1}returnToList(){this.router.navigateByUrl("/pages/polist")}showDocumentDetail(){this.showAddDocumentDetail=!0}savePoReception(){""!=this.documentDetail?(this.hideDialog(),this.onSubmit()):this.messageService.add({severity:"error",summary:"Error",detail:"No puede dejar el campo de referencia vacio",life:3e3})}PostAccountTransaction(e){e.userId=this.eventService.getToken(),this.IsLoading=!0,this.productService.AddPO(e).subscribe(i=>{console.log(i),i.data?(this.messageService.add({severity:"success",summary:"Success",detail:"Exito al guardar los datos, usted ser\xe1 redirigido a la pagina de lista de ordenes de compra",life:3e3}),setTimeout(()=>{this.returnToList()},3e3)):this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.IsLoading=!1},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:3e3}),this.IsLoading=!1})}GetProductsByWareHouse(){this.IsLoading=!0,this.productService.getProductsByWareHouse(this.eventService.getToken()).subscribe(e=>{if(e.data){const i=e.data.map(o=>({code:o.productId,name:o.productName,price:o.productPrice}));this.products=[],this.products=i}else this.messageService.add({severity:"error",summary:"Error",detail:"No tiene productos creados",life:3e3})},e=>{this.messageService.add({severity:"error",summary:"Error",detail:e.message,life:6e3})})}GetPurchaseOrder(e){this.IsLoading=!0,this.productService.getPurchaseOrder(e,this.eventService.getToken()).subscribe(i=>{if(i.data){const o=i.data.pay.map(s=>({id:s.poId,payEnterpriseId:s.payEnterpriseId,nombre:s.name,total:s.amount}));if(this.items=[],this.items=o,!this.isCreating){this.supplierName=i.data.customerName;const s=i.data.lines.map(l=>({productSearch:l.productCode,productCode:l.productCode,productName:l.productName,quantity:l.quantity,unitPrice:l.unitPrice,discounts:l.discounts,total:l.total}));this.initialLines=[],this.initialLines=s,this.initializeInitialLines()}}else this.messageService.add({severity:"error",summary:"Error",detail:"No tiene productos creados",life:3e3});this.IsLoading=!1},i=>{this.messageService.add({severity:"error",summary:"Error",detail:i.message,life:6e3})})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(h.gz),t.Y36(h.F0),t.Y36(d.qu),t.Y36(p.M),t.Y36(m.P),t.Y36(v.ez))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["app-invoice-creator"]],features:[t._Bn([v.ez])],decls:53,vars:29,consts:[[4,"ngIf"],[1,"card","px-6","py-6"],[1,"invoice-title"],["styleClass","mb-4"],["pTemplate","left"],["pTemplate","right"],[1,"invoice-form",3,"formGroup"],[1,"invoice-card"],[1,"invoice-header"],[1,"form-field"],[1,"form-field","narrow"],[1,"line-actions"],["formArrayName","lines"],["class","invoice-line",3,"formGroupName",4,"ngFor","ngForOf"],[3,"ngClass"],["type","button",1,"btn","btn-submit",3,"disabled","click"],["header","Agregar Pago",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["header","Agregar Referencia del documento",1,"p-fluid",3,"visible","modal","visibleChange"],[1,"my-2"],["routerLink","/pages/polist"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-arrow-circle-left",1,"mr-2","inline-block"],["class","field col",4,"ngIf"],[1,"field","col"],["for","price"],[3,"showFilter","IsCreating","DropDownDataSource","ValueSelectedChange"],["pButton","","pRipple","","label","Metodos de Pago","icon","pi pi-plus",1,"p-button-help",3,"click"],[1,"invoice-line",3,"formGroupName"],["placeholder","Buscar...","type","text",1,"bordered-input",3,"formControlName","matAutocomplete"],["auto","matAutocomplete"],["matTooltipPosition","above",3,"value","matTooltip",4,"ngFor","ngForOf"],["type","text","formControlName","productCode","readonly","",1,"bordered-input"],["type","text","formControlName","productName","readonly","",1,"bordered-input"],["type","number","formControlName","quantity","min","1",1,"bordered-input"],["type","number","formControlName","unitPrice","min","0",1,"bordered-input"],["type","number","formControlName","discounts","min","0",1,"bordered-input"],["type","number","formControlName","total","readonly","",1,"bordered-input"],["icon","pi pi-plus","styleClass","p-button-rounded p-button-success p-button-text",3,"click"],["icon","pi pi-trash","styleClass","p-button-rounded p-button-danger p-button-text",3,"click"],["matTooltipPosition","above",3,"value","matTooltip"],[1,"item-list"],["class","item-row",4,"ngFor","ngForOf"],[1,"item-row"],[1,"item-id"],[1,"item-name"],["type","number",1,"item-total",3,"ngModel","ngModelChange"],["pButton","","pRipple","","label","Regresar","icon","pi pi-replay",1,"p-button-text",3,"click"],["type","text","placeholder","Referencia como ser N. Factura etc...",3,"ngModel","ngModelChange"],["pButton","","pRipple","","label","Guardar y Recibir Orden","icon","pi pi-plus",1,"p-button-text",3,"click"]],template:function(i,o){1&i&&(t.YNc(0,ut,2,0,"div",0),t._UZ(1,"p-toast"),t.TgZ(2,"div",1)(3,"h2",2),t._uU(4),t.qZA(),t.TgZ(5,"p-toolbar",3),t.YNc(6,_t,3,2,"ng-template",4),t.YNc(7,gt,1,0,"ng-template",5),t.qZA(),t.TgZ(8,"form",6)(9,"div",7)(10,"div",8)(11,"div",9),t._uU(12,"Producto"),t.qZA(),t.TgZ(13,"div",9),t._uU(14,"C\xf3digo"),t.qZA(),t.TgZ(15,"div",9),t._uU(16,"Nombre"),t.qZA(),t.TgZ(17,"div",10),t._uU(18,"Cantidad"),t.qZA(),t.TgZ(19,"div",10),t._uU(20,"Precio U"),t.qZA(),t.TgZ(21,"div",10),t._uU(22,"Descuentos"),t.qZA(),t.TgZ(23,"div",10),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"div",11),t._uU(26,"Acciones"),t.qZA()(),t.TgZ(27,"div",12),t.YNc(28,vt,21,4,"div",13),t.qZA(),t.TgZ(29,"span")(30,"strong"),t._uU(31),t.ALo(32,"currency"),t.qZA()(),t.TgZ(33,"span")(34,"strong"),t._uU(35),t.ALo(36,"currency"),t.qZA()(),t.TgZ(37,"span",14)(38,"strong"),t._uU(39),t.ALo(40,"currency"),t.qZA()(),t.TgZ(41,"button",15),t.NdJ("click",function(){return o.savePo()}),t._uU(42),t.qZA()()()(),t.TgZ(43,"p-dialog",16),t.NdJ("visibleChange",function(l){return o.showAddPayments=l}),t.YNc(44,yt,6,6,"ng-template",17),t.YNc(45,bt,1,0,"ng-template",18),t.qZA(),t.TgZ(46,"p-dialog",19),t.NdJ("visibleChange",function(l){return o.showAddDocumentDetail=l}),t.YNc(47,Tt,3,1,"ng-template",17),t.YNc(48,Pt,2,0,"ng-template",18),t.qZA(),t.TgZ(49,"p-toolbar",3)(50,"div",20)(51,"a",21),t._UZ(52,"button",22),t.qZA()()()),2&i&&(t.Q6J("ngIf",o.IsLoading),t.xp6(4),t.hij(" ",o.isCreating?"Crear Orden de Compra":"Recibir y completar orden de compra"," "),t.xp6(4),t.Q6J("formGroup",o.invoiceForm),t.xp6(20),t.Q6J("ngForOf",o.lines.controls),t.xp6(3),t.hij("Total General: ",t.xi3(32,18,o.calculateTotal(),"L. ")," "),t.xp6(4),t.hij("Metodos de Pago: ",t.xi3(36,21,o.calculatePaymentTotal(),"L. ")," "),t.xp6(2),t.Q6J("ngClass",o.calculateTotal()-o.calculatePaymentTotal()==0?"green-text":"red-text"),t.xp6(2),t.hij("Balance: ",t.xi3(40,24,o.calculateTotal()-o.calculatePaymentTotal(),"L. "),""),t.xp6(2),t.Q6J("disabled",!o.invoiceForm.valid),t.xp6(1),t.hij(" ",o.isCreating?"Crear Orden de Compra":"Recibir y completar orden de compra",""),t.xp6(1),t.Akn(t.DdM(27,xt)),t.Q6J("visible",o.showAddPayments)("modal",!0),t.xp6(3),t.Akn(t.DdM(28,It)),t.Q6J("visible",o.showAddDocumentDetail)("modal",!0))},dependencies:[r.mk,r.sg,r.O5,h.rH,d._Y,d.Fj,d.wV,d.JJ,d.JL,d.qQ,d.On,u.Hq,u.zx,d.sg,d.u,d.x0,d.CE,b.R,E.t,M.XC,M.ZL,S.ey,F.FN,v.jx,B.o,U.V,lt,r.H9],styles:["[_ngcontent-%COMP%]:root{--primary-color: #023b78;--secondary-color: #1565bb;--background-color: #f0f8ff;--text-color: #333;--border-color: #ccc;--hover-color: #e9ecef}.bordered-input[_ngcontent-%COMP%]{background-color:#007bff37}body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;background-color:var(--background-color);color:var(--text-color)}.h5[_ngcontent-%COMP%]{background-color:var(--primary-color)}.invoice-form[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.invoice-card[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 2px 4px #0000001a;padding:20px}.invoice-title[_ngcontent-%COMP%]{color:var(--primary-color);text-align:center;margin-bottom:20px}.invoice-header[_ngcontent-%COMP%], .invoice-line[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap;gap:10px;margin-bottom:15px;align-items:center}.invoice-header[_ngcontent-%COMP%]{font-weight:700;color:var(--primary-color)}.form-field[_ngcontent-%COMP%]{flex:2;display:flex;flex-direction:column}.form-field.narrow[_ngcontent-%COMP%]{flex:1}label[_ngcontent-%COMP%]{margin-bottom:5px;color:var(--primary-color)}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:8px;border:1px solid var(--border-color);border-radius:4px;font-size:14px;width:100%;transition:border-color .3s ease,box-shadow .3s ease}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--secondary-color);box-shadow:0 0 0 2px #007bff40}input[formControlName][_ngcontent-%COMP%], select[formControlName][_ngcontent-%COMP%]{border:1px solid var(--border-color)!important}[formControlName][_ngcontent-%COMP%]{border:1px solid var(--border-color);border-radius:10px;transition:border-color .3s ease,box-shadow .3s ease}[formControlName][_ngcontent-%COMP%]:focus{border-color:var(--secondary-color);box-shadow:0 0 0 2px #007bff40}.line-actions[_ngcontent-%COMP%]{display:flex;gap:5px;align-items:center;flex:0 0 auto}.btn[_ngcontent-%COMP%]{padding:8px 12px;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .3s ease}.btn-add[_ngcontent-%COMP%]{background-color:var(--secondary-color);color:#fff}.btn-remove[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-submit[_ngcontent-%COMP%]{background-color:var(--primary-color);color:#fff;margin-top:20px;width:100%;padding:10px 15px}.btn[_ngcontent-%COMP%]:hover{opacity:.9}.btn[_ngcontent-%COMP%]:disabled{background-color:var(--border-color);cursor:not-allowed}.mat-autocomplete-panel[_ngcontent-%COMP%]{background-color:#fff;border:1px solid var(--border-color);border-radius:4px;box-shadow:0 2px 4px #0000001a}.mat-option[_ngcontent-%COMP%]{padding:8px;font-size:14px;transition:background-color .3s ease}.mat-option[_ngcontent-%COMP%]:hover, .mat-option.mat-active[_ngcontent-%COMP%]{background-color:var(--hover-color)}@media (max-width: 768px){.invoice-header[_ngcontent-%COMP%], .invoice-line[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.form-field[_ngcontent-%COMP%], .form-field.narrow[_ngcontent-%COMP%]{width:100%;flex:1}.line-actions[_ngcontent-%COMP%]{margin-top:10px;justify-content:flex-end}}.item-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin:20px}.item-row[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px;border:1px solid #ddd;border-radius:4px;background-color:#f9f9f9;box-shadow:0 2px 3px #0000001a}.item-id[_ngcontent-%COMP%], .item-name[_ngcontent-%COMP%]{flex:1;margin-right:10px;font-size:1em;color:#333}.item-total[_ngcontent-%COMP%]{width:100px;padding:5px;border-radius:4px;border:1px solid #ccc;font-size:1em;text-align:right}.green-text[_ngcontent-%COMP%]{color:green}.red-text[_ngcontent-%COMP%]{color:red}"]})}return n})(),Ot=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#i=this.\u0275inj=t.cJS({imports:[h.Bz.forChild([{path:"",component:Mt}]),h.Bz]})}return n})();var X=a(4891);let At=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#i=this.\u0275inj=t.cJS({imports:[r.ez,Ot,d.u5,u.hJ,d.UX,X.E,M.Bb,F.EV,B.V,U.S,X.E,pt]})}return n})()},1383:(w,y,a)=>{a.d(y,{V:()=>t,o:()=>v});var r=a(4650),h=a(6895),d=a(805);function f(p,m){1&p&&r.GkF(0)}function O(p,m){if(1&p&&(r.TgZ(0,"div",3),r.YNc(1,f,1,0,"ng-container",4),r.qZA()),2&p){const u=r.oxw();r.xp6(1),r.Q6J("ngTemplateOutlet",u.leftTemplate)}}function I(p,m){1&p&&r.GkF(0)}function g(p,m){if(1&p&&(r.TgZ(0,"div",5),r.YNc(1,I,1,0,"ng-container",4),r.qZA()),2&p){const u=r.oxw();r.xp6(1),r.Q6J("ngTemplateOutlet",u.rightTemplate)}}const A=["*"];let v=(()=>{class p{constructor(u){this.el=u}getBlockableElement(){return this.el.nativeElement.children[0]}ngAfterContentInit(){this.templates.forEach(u=>{switch(u.getType()){case"left":this.leftTemplate=u.template;break;case"right":this.rightTemplate=u.template}})}}return p.\u0275fac=function(u){return new(u||p)(r.Y36(r.SBq))},p.\u0275cmp=r.Xpm({type:p,selectors:[["p-toolbar"]],contentQueries:function(u,b,E){if(1&u&&r.Suo(E,d.jx,4),2&u){let M;r.iGM(M=r.CRH())&&(b.templates=M)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:A,decls:4,vars:6,consts:[["role","toolbar",3,"ngClass","ngStyle"],["class","p-toolbar-group-left",4,"ngIf"],["class","p-toolbar-group-right",4,"ngIf"],[1,"p-toolbar-group-left"],[4,"ngTemplateOutlet"],[1,"p-toolbar-group-right"]],template:function(u,b){1&u&&(r.F$t(),r.TgZ(0,"div",0),r.Hsn(1),r.YNc(2,O,2,1,"div",1),r.YNc(3,g,2,1,"div",2),r.qZA()),2&u&&(r.Tol(b.styleClass),r.Q6J("ngClass","p-toolbar p-component")("ngStyle",b.style),r.xp6(2),r.Q6J("ngIf",b.leftTemplate),r.xp6(1),r.Q6J("ngIf",b.rightTemplate))},dependencies:[h.mk,h.O5,h.tP,h.PC],styles:[".p-toolbar{display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap}.p-toolbar-group-left,.p-toolbar-group-right{display:flex;align-items:center}\n"],encapsulation:2,changeDetection:0}),p})(),t=(()=>{class p{}return p.\u0275fac=function(u){return new(u||p)},p.\u0275mod=r.oAB({type:p}),p.\u0275inj=r.cJS({imports:[h.ez]}),p})()}}]);